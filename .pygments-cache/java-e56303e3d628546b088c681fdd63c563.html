<div class="highlight"><pre><span class="n">AppWidgetManager</span> <span class="n">widgetManager</span> <span class="o">=</span> <span class="n">AppWidgetManager</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>

<span class="n">Timer</span> <span class="n">timer</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Timer</span><span class="o">();</span>

<span class="n">TimerTask</span> <span class="n">timerTask</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">TimerTask</span><span class="o">(){</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(){</span>
		<span class="n">RemoteViews</span> <span class="n">views</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">RemoteView</span><span class="o">(</span><span class="n">getPackageName</span><span class="o">(),</span> <span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">process_widget</span><span class="o">);</span>
		<span class="n">view</span><span class="o">.</span><span class="na">setTextViewText</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">process_count</span><span class="o">,</span> <span class="s">&quot;正在运行软件1个&quot;</span><span class="o">);</span>

		<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">();</span>
		<span class="n">intent</span><span class="o">.</span><span class="na">setAction</span><span class="o">(</span><span class="s">&quot;aaa.bbb.ccc&quot;</span><span class="o">);</span>
		<span class="n">PendingIntent</span> <span class="n">pendingIntent</span> <span class="o">=</span> <span class="n">PendingIntent</span><span class="o">.</span><span class="na">getBroadcast</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span>
									<span class="mi">0</span><span class="o">,</span> <span class="n">intent</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>

		<span class="c1">//当点击后触发广播来执行</span>
		<span class="n">view</span><span class="o">.</span><span class="na">setOnClickPendingIntent</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">button</span><span class="o">,</span> <span class="n">pendingIntent</span><span class="o">);</span>

		<span class="c1">//第一个参数表示上下文</span>
		<span class="c1">//第二个参数表示当前有哪一个广播进行去处理当前的桌面小控件</span>
		<span class="n">ComponentName</span> <span class="n">provider</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">ComponentName</span><span class="o">(</span><span class="n">getApplicationContent</span><span class="o">(),</span> <span class="n">MyAppWidget</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="n">widgetManager</span><span class="o">.</span><span class="na">updateAppWidget</span><span class="o">(</span><span class="n">provider</span><span class="o">,</span> <span class="n">view</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">};</span>

<span class="n">timer</span><span class="o">.</span><span class="na">schedule</span><span class="o">(</span><span class="n">timerTask</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">5000</span><span class="o">);</span>
</pre></div>